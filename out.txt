Namespace(all=0, alpha=0.5, augment_num=50, batch_size=16, dataset=None, dropout=0.3, emb_dim=128, epochs=10, h_dim=128, heads=8, inter_only=True, layers=1, learning_rate=0.01, min_size=1000, mix_type=1, model='Transformer', n_splits=2, norm_first=False, pca=True, repeat=1, same_pheno=-1, seed=100, task='stage', test_num_sample=50, test_sample_cells=500, top_k=1, train_num_sample=20, train_sample_cells=500, warmup=False, weight_decay=0.0001)
======= sample mixup ... ============
cuda
Epoch 1, Train Loss 0.500428, Valid_loss 0.538903
Epoch 2, Train Loss 0.423598, Valid_loss 0.577604
Epoch 3, Train Loss 0.411170, Valid_loss 0.595107
P-M002 -- true: progression -- pred: progression
P-M006 -- true: convalescence -- pred: convalescence
P-M007 -- true: convalescence -- pred: convalescence
P-M008 -- true: convalescence -- pred: convalescence
P-M010 -- true: convalescence -- pred: convalescence
P-M011 -- true: convalescence -- pred: convalescence
P-M014 -- true: convalescence -- pred: convalescence
P-M015 -- true: convalescence -- pred: convalescence
P-M018 -- true: convalescence -- pred: convalescence
P-M019 -- true: convalescence -- pred: convalescence
P-M020 -- true: convalescence -- pred: convalescence
P-M021 -- true: convalescence -- pred: convalescence
P-M022 -- true: convalescence -- pred: convalescence
P-M024 -- true: convalescence -- pred: convalescence
P-M025 -- true: convalescence -- pred: convalescence
P-M026 -- true: progression -- pred: progression
P-M027 -- true: convalescence -- pred: convalescence
P-M029 -- true: convalescence -- pred: convalescence
P-M030 -- true: convalescence -- pred: convalescence
P-M033 -- true: convalescence -- pred: convalescence
P-M035 -- true: convalescence -- pred: convalescence
P-M037 -- true: convalescence -- pred: progression
P-M038 -- true: convalescence -- pred: progression
P-M039 -- true: convalescence -- pred: convalescence
P-M041 -- true: progression -- pred: progression
P-M042 -- true: convalescence -- pred: progression
P-M042 -- true: progression -- pred: progression
P-M045 -- true: convalescence -- pred: convalescence
P-M048 -- true: convalescence -- pred: convalescence
P-M049 -- true: progression -- pred: progression
P-M053 -- true: convalescence -- pred: convalescence
P-M056 -- true: progression -- pred: convalescence
P-M059 -- true: convalescence -- pred: convalescence
P-M060 -- true: convalescence -- pred: convalescence
P-M064 -- true: convalescence -- pred: convalescence
P-M068 -- true: progression -- pred: convalescence
P-M069 -- true: convalescence -- pred: convalescence
P-M070 -- true: convalescence -- pred: convalescence
P-M072 -- true: convalescence -- pred: convalescence
P-M076 -- true: progression -- pred: progression
P-M077 -- true: progression -- pred: progression
P-S001 -- true: progression -- pred: progression
P-S007 -- true: progression -- pred: progression
P-S008 -- true: progression -- pred: progression
P-S010 -- true: progression -- pred: progression
P-S012 -- true: progression -- pred: progression
P-S015 -- true: convalescence -- pred: convalescence
P-S016 -- true: convalescence -- pred: convalescence
P-S017 -- true: convalescence -- pred: convalescence
P-S019 -- true: convalescence -- pred: convalescence
P-S021 -- true: convalescence -- pred: convalescence
P-S022 -- true: convalescence -- pred: convalescence
P-S031 -- true: convalescence -- pred: convalescence
P-S032 -- true: convalescence -- pred: progression
P-S033 -- true: convalescence -- pred: convalescence
P-S034 -- true: convalescence -- pred: convalescence
P-S035 -- true: convalescence -- pred: convalescence
P-S035 -- true: progression -- pred: convalescence
P-S036 -- true: progression -- pred: progression
P-S037 -- true: progression -- pred: progression
P-S040 -- true: progression -- pred: progression
P-S041 -- true: progression -- pred: progression
P-S044 -- true: progression -- pred: progression
P-S050 -- true: progression -- pred: progression
P-S051 -- true: progression -- pred: progression
P-S053 -- true: progression -- pred: progression
P-S056 -- true: progression -- pred: progression
P-S057 -- true: progression -- pred: progression
P-S059 -- true: progression -- pred: progression
P-S062 -- true: convalescence -- pred: convalescence
P-S064 -- true: convalescence -- pred: convalescence
P-S065 -- true: convalescence -- pred: convalescence
P-S066 -- true: convalescence -- pred: convalescence
P-S067 -- true: convalescence -- pred: convalescence
P-S068 -- true: convalescence -- pred: convalescence
P-S072 -- true: progression -- pred: convalescence
P-S074 -- true: progression -- pred: convalescence
P-S075 -- true: progression -- pred: convalescence
P-S077 -- true: convalescence -- pred: convalescence
P-S078 -- true: convalescence -- pred: convalescence
P-S079 -- true: convalescence -- pred: convalescence
P-S080 -- true: convalescence -- pred: convalescence
P-S082 -- true: convalescence -- pred: convalescence
P-S084 -- true: convalescence -- pred: convalescence
P-S085 -- true: progression -- pred: progression
P-S086 -- true: progression -- pred: progression
P-S089 -- true: progression -- pred: progression
P-S092 -- true: progression -- pred: progression
Best performance: Epoch 1, Loss 0.500428, Test ACC 0.886364, Test AUC 0.904683, Test Recall 0.818182, Test Precision 0.870968
Confusion Matrix: [51  4  6 27]
======= sample mixup ... ============
cuda
Epoch 1, Train Loss 0.606349, Valid_loss 0.457888
Epoch 2, Train Loss 0.505340, Valid_loss 0.400502
Epoch 3, Train Loss 0.503234, Valid_loss 0.412421
Epoch 4, Train Loss 0.491488, Valid_loss 0.448530
P-M001 -- true: convalescence -- pred: convalescence
P-M003 -- true: progression -- pred: progression
P-M004 -- true: convalescence -- pred: convalescence
P-M004 -- true: progression -- pred: progression
P-M005 -- true: convalescence -- pred: convalescence
P-M007 -- true: progression -- pred: progression
P-M009 -- true: convalescence -- pred: convalescence
P-M012 -- true: convalescence -- pred: convalescence
P-M013 -- true: convalescence -- pred: convalescence
P-M016 -- true: convalescence -- pred: convalescence
P-M017 -- true: convalescence -- pred: convalescence
P-M023 -- true: convalescence -- pred: convalescence
P-M026 -- true: convalescence -- pred: convalescence
P-M028 -- true: convalescence -- pred: convalescence
P-M031 -- true: convalescence -- pred: convalescence
P-M032 -- true: convalescence -- pred: convalescence
P-M034 -- true: convalescence -- pred: progression
P-M036 -- true: convalescence -- pred: convalescence
P-M040 -- true: convalescence -- pred: convalescence
P-M041 -- true: convalescence -- pred: convalescence
P-M043 -- true: convalescence -- pred: convalescence
P-M043 -- true: progression -- pred: progression
P-M044 -- true: convalescence -- pred: convalescence
P-M044 -- true: progression -- pred: progression
P-M046 -- true: progression -- pred: progression
P-M047 -- true: progression -- pred: progression
P-M050 -- true: convalescence -- pred: convalescence
P-M051 -- true: convalescence -- pred: convalescence
P-M052 -- true: convalescence -- pred: convalescence
P-M054 -- true: convalescence -- pred: convalescence
P-M055 -- true: convalescence -- pred: convalescence
P-M058 -- true: convalescence -- pred: progression
P-M061 -- true: convalescence -- pred: convalescence
P-M062 -- true: convalescence -- pred: convalescence
P-M063 -- true: convalescence -- pred: convalescence
P-M065 -- true: convalescence -- pred: convalescence
P-M066 -- true: progression -- pred: convalescence
P-M067 -- true: progression -- pred: convalescence
P-M071 -- true: convalescence -- pred: convalescence
P-M073 -- true: convalescence -- pred: convalescence
P-M074 -- true: progression -- pred: progression
P-M075 -- true: progression -- pred: progression
P-M078 -- true: progression -- pred: convalescence
P-M079 -- true: progression -- pred: convalescence
P-S004 -- true: progression -- pred: progression
P-S005 -- true: progression -- pred: progression
P-S011 -- true: progression -- pred: progression
P-S013 -- true: convalescence -- pred: convalescence
P-S014 -- true: convalescence -- pred: convalescence
P-S018 -- true: convalescence -- pred: convalescence
P-S020 -- true: convalescence -- pred: convalescence
P-S023 -- true: convalescence -- pred: convalescence
P-S024 -- true: convalescence -- pred: convalescence
P-S025 -- true: convalescence -- pred: convalescence
P-S026 -- true: convalescence -- pred: convalescence
P-S027 -- true: convalescence -- pred: convalescence
P-S028 -- true: convalescence -- pred: convalescence
P-S029 -- true: convalescence -- pred: convalescence
P-S030 -- true: convalescence -- pred: convalescence
P-S032 -- true: progression -- pred: convalescence
P-S036 -- true: convalescence -- pred: convalescence
P-S038 -- true: progression -- pred: progression
P-S039 -- true: progression -- pred: progression
P-S042 -- true: progression -- pred: progression
P-S043 -- true: progression -- pred: progression
P-S045 -- true: progression -- pred: convalescence
P-S046 -- true: progression -- pred: progression
P-S047 -- true: progression -- pred: progression
P-S048 -- true: progression -- pred: progression
P-S049 -- true: progression -- pred: progression
P-S052 -- true: progression -- pred: progression
P-S054 -- true: progression -- pred: progression
P-S055 -- true: progression -- pred: progression
P-S058 -- true: progression -- pred: progression
P-S060 -- true: convalescence -- pred: convalescence
P-S061 -- true: progression -- pred: convalescence
P-S063 -- true: convalescence -- pred: convalescence
P-S069 -- true: progression -- pred: progression
P-S070 -- true: progression -- pred: progression
P-S071 -- true: progression -- pred: progression
P-S073 -- true: progression -- pred: progression
P-S076 -- true: progression -- pred: convalescence
P-S081 -- true: convalescence -- pred: convalescence
P-S083 -- true: convalescence -- pred: convalescence
P-S087 -- true: progression -- pred: progression
P-S088 -- true: progression -- pred: progression
P-S090 -- true: progression -- pred: progression
P-S091 -- true: convalescence -- pred: progression
Best performance: Epoch 2, Loss 0.505340, Test ACC 0.875000, Test AUC 0.912088, Test Recall 0.794872, Test Precision 0.911765
Confusion Matrix: [46  3  8 31]
=================================
=== Final Evaluation (average across all splits) ===
=================================
Best performance: Test ACC 0.880682,   Test AUC 0.908386,   Test Recall 0.806527,   Test Precision 0.891366
